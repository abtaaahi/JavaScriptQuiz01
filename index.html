<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Portal</title>
    <style>
        body, html {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .mcq-section, .written-section, .result-section {
            width: 80%;
            max-width: 800px;
            margin: 20px;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .question {
            margin-bottom: 10px;
        }
        .options {
            margin-bottom: 20px;
        }
        .options label {
            display: block;
        }
        .submit-btn {
            padding: 10px 20px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="mcq-section" id="mcq-section">
            <h2>Multiple Choice Questions</h2>
            <form id="mcq-form"></form>
            <button class="submit-btn" onclick="submitMcq()">Submit and Proceed to Written Exam</button>
        </div>
        <div class="written-section" id="written-section" style="display: none;">
            <h2>Written Exam</h2>
            <form id="written-form"></form>
            <button class="submit-btn" onclick="submitWritten()">Submit Written Exam</button>
        </div>
        <div class="result-section" id="result-section" style="display: none;">
            <h2>Results</h2>
            <div id="mcq-results"></div>
            <p>Written exam results will be published later.</p>
        </div>
    </div>

    <script>
        const mcqQuestions = [
            {
                question: "What is the correct syntax for referring to an external script called 'script.js'?",
                options: ["script href='script.js' ", "script name='script.js'", "script src='script.js'", "script file='script.js'", "script url='script.js'", "script link='script.js'"],
                answer: 2
            },
            {
                question: "How do you write 'Hello World' in an alert box?",
                options: ["msg('Hello World');", "alertBox('Hello World');", "msgBox('Hello World');", "alert('Hello World');", "display('Hello World');", "show('Hello World');"],
                answer: 3
            },
            {
                question: "How to write an IF statement in JavaScript?",
                options: ["if i == 5 then", "if i = 5 then", "if (i == 5)", "if i = 5", "if (i = 5)", "if (i === 5)"],
                answer: 2
            },
            {
                question: "How does a WHILE loop start?",
                options: ["while i = 1 to 10", "while (i <= 10; i++)", "while (i <= 10)", "while (i < 10)", "while (i => 10)", "while (i >= 10)"],
                answer: 2
            },
            {
                question: "Which event occurs when the user clicks on an HTML element?",
                options: ["onchange", "onclick", "onmouseclick", "onmouseover", "onmousein", "onmouseup"],
                answer: 1
            },
            {
                question: "How do you declare a JavaScript variable?",
                options: ["var carName;", "variable carName;", "v carName;", "let carName;", "const carName;", "declare carName;"],
                answer: 0
            },
            {
                question: "Which operator is used to assign a value to a variable?",
                options: ["*", "x", "=", "-", "+", "%"],
                answer: 2
            },
            {
                question: "What will the following code return: Boolean(10 > 9)?",
                options: ["false", "NaN", "true", "null", "undefined", "error"],
                answer: 2
            },
            {
                question: "Is JavaScript case-sensitive?",
                options: ["Yes", "No", "Sometimes", "Depends on the browser", "Depends on the OS", "Depends on the environment"],
                answer: 0
            },
            {
                question: "Which method is used to remove the last element from an array?",
                options: ["pop()", "push()", "shift()", "unshift()", "splice()", "slice()"],
                answer: 0
            },
            {
                question: "Which operator is used to spread elements of an array or object?",
                options: ["...", "++", "--", "**", "&", "@@"],
                answer: 0
            },
            {
                question: "What is a promise in JavaScript?",
                options: ["An object representing the eventual completion or failure of an asynchronous operation", "A function that executes asynchronously", "A method to handle events", "A callback function", "An event handler", "A closure"],
                answer: 0
            },
            {
                question: "Which method is used to convert a JSON object to a string?",
                options: ["JSON.stringify()", "JSON.parse()", "toString()", "Stringify()", "JSON.toString()", "String.parse()"],
                answer: 0
            },
            {
                question: "How do you declare a function in JavaScript?",
                options: ["function myFunction() {}", "def myFunction() {}", "func myFunction() {}", "let myFunction() {}", "const myFunction() {}", "var myFunction() {}"],
                answer: 0
            },
            {
                question: "Which loop is guaranteed to execute at least once?",
                options: ["do-while loop", "for loop", "while loop", "foreach loop", "repeat-until loop", "none"],
                answer: 0
            },
            {
                question: "How do you create a new object in JavaScript?",
                options: ["var obj = {}", "var obj = []", "var obj = ()", "let obj = {}", "const obj = []", "let obj = ()"],
                answer: 0
            },
            {
                question: "Which method can be used to filter elements of an array in JavaScript?",
                options: ["filter()", "find()", "reduce()", "map()", "forEach()", "some()"],
                answer: 0
            },
            {
                question: "How do you check if a variable is an array in JavaScript?",
                options: ["Array.isArray(var)", "var.isArray()", "isArray(var)", "Array.isArray(var)", "var.isArray(var)", "var.isArray()"],
                answer: 0
            },
            {
                question: "What is the output of 'typeof NaN' in JavaScript?",
                options: ["'number'", "'NaN'", "'undefined'", "'string'", "'object'", "'boolean'"],
                answer: 0
            },
            {
                question: "Which symbol is used for comments in JavaScript?",
                options: ["//", "/* */", "<!-- -->", "''", "##", "<% %>"],
                answer: 0
            }
        ];

        const writtenQuestions = [
            "Write a function in JavaScript to reverse a string.",
            "Explain closures in JavaScript with an example.",
            "Write a JavaScript program to check if a number is prime.",
            "Describe the difference between 'let' and 'var' in JavaScript.",
            "Write a function to find the factorial of a number using recursion.",
            "How does the 'this' keyword work in JavaScript? Provide an example.",
            "Write a JavaScript function to merge two arrays and remove duplicates.",
            "Explain event delegation in JavaScript with an example.",
            "Write a function to sort an array of numbers in ascending order.",
            "Describe how promises work in JavaScript with an example."
        ];

        function submitMcq() {
            alert('Proceeding to the Written Exam.');
            document.getElementById('mcq-section').style.display = 'none';
            document.getElementById('written-section').style.display = 'block';
        }

        function submitWritten() {
            alert('Submitting Written Exam.');
            document.getElementById('written-section').style.display = 'none';
            const mcqResultsDiv = document.getElementById('mcq-results');
            const formData = new FormData(mcqForm);
            let score = 0;
            let mcqResponses = '';
            mcqQuestions.forEach((q, index) => {
                const userAnswer = formData.get(`q${index}`);
                const isCorrect = userAnswer == q.answer;
                if (isCorrect) {
                    score++;
                }
                mcqResponses += `Question: ${q.question}\nSelected Option: ${q.options[userAnswer]}\nCorrect: ${isCorrect}\n\n`;
            });

            const writtenResponses = Array.from(new FormData(writtenForm)).map((entry, index) => {
                return `Question: ${writtenQuestions[index]}\nAnswer: ${entry[1]}\n\n`;
            }).join('');

            const responses = `MCQ Responses:\n${mcqResponses}\nWritten Responses:\n${writtenResponses}`;

            // Create a Blob with the responses
            const blob = new Blob([responses], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'exam_responses.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            mcqResultsDiv.innerHTML = `<p>MCQ Score: ${score} out of ${mcqQuestions.length}</p>`;
            document.getElementById('result-section').style.display = 'block';
        }

        // Initialize MCQ Form
        const mcqForm = document.getElementById('mcq-form');
        mcqQuestions.forEach((q, index) => {
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question';
            questionDiv.innerHTML = `<strong><p>${index + 1}. ${q.question}</p></strong>`;
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options';
            q.options.forEach((opt, optIndex) => {
                optionsDiv.innerHTML += `
                    <label>
                        <input type="radio" name="q${index}" value="${optIndex}" required>
                        ${opt}
                    </label>`;
            });
            questionDiv.appendChild(optionsDiv);
            mcqForm.appendChild(questionDiv);
        });

        // Initialize Written Form
        const writtenForm = document.getElementById('written-form');
        // writtenQuestions.forEach((q, index) => {
        //     const questionDiv = document.createElement('div');
        //     questionDiv.className = 'question';
        //     questionDiv.innerHTML = `<p>${index + 1}. ${q}</p>`;
        //     questionDiv.innerHTML += `<textarea name="written${index}" rows="6" cols="0" required></textarea>`;
        //     writtenForm.appendChild(questionDiv);
        // });

        writtenQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.classList.add('question');
        questionDiv.innerHTML = `<strong>Q${index + 1}. ${q}</strong>`;
        
        const answerTextarea = document.createElement('textarea');
        answerTextarea.name = `wq${index}`;
        answerTextarea.rows = 6;
        answerTextarea.style.width = '100%';
        answerTextarea.style.boxSizing = 'border-box'; // Ensures padding and border are included in the element's total width and height
        answerTextarea.style.border = '1px solid #ccc';
        answerTextarea.style.borderRadius = '5px';
        answerTextarea.style.padding = '10px';
        
        questionDiv.appendChild(answerTextarea);
        writtenForm.appendChild(questionDiv);
    });

        let time = 60 * 60; 
        const timerElement = document.createElement('div');
        timerElement.id = 'timer';
        timerElement.style.position = 'fixed';
        timerElement.style.top = '10px';
        timerElement.style.right = '10px';
        timerElement.style.backgroundColor = '#f0f0f0';
        timerElement.style.padding = '10px';
        timerElement.style.border = '1px solid #ccc';
        timerElement.style.borderRadius = '5px';
        document.body.appendChild(timerElement);

        function updateTimer() {
            const minutes = Math.floor(time / 60);
            const seconds = time % 60;
            timerElement.textContent = `Time Left: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            if (time > 0) {
                time--;
            } else {
                clearInterval(timerInterval);
                submitWritten();
            }
        }
        const timerInterval = setInterval(updateTimer, 1000);
        document.addEventListener('copy', (e) => {
            e.preventDefault();
            alert('Copying text is not allowed on this page.');
        });


    </script>
</body>
</html>
